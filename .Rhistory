busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$X <- converted$x
busstopscsv$Y <- converted$y
overlay <- stat_density2d(aes(x= X, y = Y, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = X, y = Y, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
sgmap + overlay
testoverlay <- geom_point(aes(x = Y, y = X, colour = timeden, size = timeden), data = busstopscsv)
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
proj4string <- "+proj=utm +zone=48M +north +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil1 = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$x
busstopscsv$lat <- converted$y
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = lat, y = Y=long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = Y=long, colour = timeden, size = timeden), data = busstopscsv)
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
proj4string <- "+proj=utm +zone=48 +north +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil1 = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$x
busstopscsv$lat <- converted$y
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
sgosm <- get_map("singapore", zoom = 3)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
View(busstopscsv)
testoverlay <- geom_point(aes(x = laty, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
sgmap + overlay
library(ggmap)
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil1 = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$x
busstopscsv$lat <- converted$y
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$long <- 103.851959
busstopscsv$lat <- 1.290270
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$long <- converted$x
busstopscsv$lat <- converted$y
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$long <- 1.290270
busstopscsv$lat <- 	103.851959
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$long <- converted$x
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
View(titosamplecsv)
View(busstopscsv)
busstopscsv <- read.csv("./data/coded_stops.csv")
View(busstopscsv)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
busstopscsv$long <- 103.851959
busstopscsv$lat <- 	1.290270
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
sgmap + testoverlay
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
proj4string <- "+proj=utm +zone=48N +ellps=SVY21 +datum=SVY21 +units=m +no_defs "
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv2 <- read.csv("./data/coded_stops2.csv")
View(busstopscsv2)
View(busstopscsv)
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil1 = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
busstopscsv$long <- 103.851959
busstopscsv$lat <- 	1.290270
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
View(busstopscsv)
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
#proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
proj4string <- "+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs"
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil1 = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
#busstopscsv$long <- 103.851959
#busstopscsv$lat <- 	1.290270
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = long, y = lat, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = timeden), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = ..level.., size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = ..timeden.., size = timeden), data = busstopscsv)
sgmap + testoverlay
testoverlay <- geom_point(aes(x = lat, y = long, colour = timeden, size = timeden), data = busstopscsv)
sgmap + testoverlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = timeden), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = timeden), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = timeden), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden, alpha = 0.2), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = timeden), bins = 4, geom = "polygon", data = busstopscsv)
sgmap + overlay
overlay <- geom_point(data=PopDensity, aes(x=lat,y=long,size=timeden), alpha = 0.3)
overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3)
sgmap + overlay
overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 2)
sgmap + overlay
overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
runApp()
View(titosamplecsv)
fil$x <- sapply(fil$BOARDING_STOP_STN, FUN=function(x) busstopscsv[busstopscsv$BUS_STOP_N==x], "X")
fil$x <- sapply(fil$BOARDING_STOP_STN, FUN=function(x) busstopscsv[busstopscsv$BUS_STOP_N==x], "X")
fil = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
fil$x <- sapply(fil$BOARDING_STOP_STN, FUN=function(x) busstopscsv[busstopscsv$BUS_STOP_N==x], "X")
fil$x <- sapply(fil$BOARDING_STOP_STN, FUN=function(x) busstopscsv[busstopscsv$BUS_STOP_N==x]$X)
View(busstopscsv)
fil$x <- sapply(fil$BOARDING_STOP_STN, FUN=function(x) busstopscsv[busstopscsv$BUS_STOP_N==x]$X)
fil$x <- busstopscsv$X[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
View(fil)
fil$y <- busstopscsv$Y[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
coords = fil$x$y
converted <- project(fil, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
View(fil)
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil)
sgmap + overlay
overlay <- geom_point(data=fil, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil, na.rm = TRUE)
sgmap + overlay
View(fil)
fil$long <- converted$x
fil$lat <- converted$y
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil, na.rm = TRUE)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil)
sgmap + overlay
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
converted <- project(fil, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
holding$x <- fil$x
holding
holding <- []
holding = []
holding<- fil$x
holding$y <- fil$y
df <- data.frame(x=num(), y=num())
df <- data.frame()
holding$x <- fil$x
holding$y <- fil$y
holding <- data.frame()
holding$x <- fil$x
holding$y <- fil$y
holding <- data.frame()
holding$x <- fil$x
holding <- data.frame(x,y)
holding <- data.frame(x=double(),y=double())
holding$x <- fil$x
holding <- subset(fil, select = c(9,10))
View(holding)
converted <- project(holding, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil)
sgmap + overlay
runApp()
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
#proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
proj4string <- "+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs"
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil = filter(titosamplecsv, 000000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
#busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
fil$x <- busstopscsv$X[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
fil$y <- busstopscsv$Y[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
holding <- subset(fil, select = c(9,10))
converted <- project(holding, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil)
#overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
View(fil)
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
#proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
proj4string <- "+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs"
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil = filter(titosamplecsv, 000000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
#busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
fil$x <- busstopscsv$X[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
fil$y <- busstopscsv$Y[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
holding <- subset(fil, select = c(9,10))
converted <- project(holding, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 4, geom = "polygon", data = fil)
#overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
View(fil)
View(holding)
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 10, geom = "polygon", data = fil)
sgmap + overlay
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
#proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
proj4string <- "+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs"
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil = filter(titosamplecsv, 230000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
#busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
fil$x <- busstopscsv$X[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
fil$y <- busstopscsv$Y[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
holding <- subset(fil, select = c(9,10))
converted <- project(holding, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 10, geom = "polygon", data = fil)
#overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
#proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
proj4string <- "+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs"
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil = filter(titosamplecsv, 235800 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
#busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
fil$x <- busstopscsv$X[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
fil$y <- busstopscsv$Y[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
holding <- subset(fil, select = c(9,10))
converted <- project(holding, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 10, geom = "polygon", data = fil)
#overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
sgmap + overlay
runApp()
runApp()
library(shiny)
library(rgdal)
library(spatstat)
library(maptools)
library(stplanr)
library(dplyr)
library(ggmap)
library(proj4)
#proj4string <- "+proj=utm +zone=48N +ellps=WGS84 +datum=WGS84 +units=m +no_defs "
proj4string <- "+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +datum=WGS84 +units=m +no_defs"
setwd("/Users/limshiquan/Desktop/git projects/geobus")
sgowin <- as.owin(readOGR(dsn = './data/outline', layer = "MP14_PLNG_AREA_WEB_PL"))
busstopscsv <- read.csv("./data/coded_stops.csv")
titosamplecsv <- read.csv("./data/bus_sample.csv")
sgosm <- get_map("singapore", zoom = 11)
sgmap <- ggmap(sgosm, extent = "device", legend = "topleft")
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin)
busstopsppp <- ppp(busstopscsv[,1], busstopscsv[,2], window = sgowin, marks = busstopscsv[,6])
plot(busstopsppp)
fil = filter(titosamplecsv, 000000 < as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) & as.numeric(gsub("[: -]", "" , RIDE_START_TIME, perl=TRUE)) < 235910)
#busstopscsv$timeden <- sapply(busstopscsv$BUS_STOP_N, FUN=function(x) length(fil1[fil1$BOARDING_STOP_STN==x, "BOARDING_STOP_STN"]))
fil$x <- busstopscsv$X[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
fil$y <- busstopscsv$Y[match(fil$BOARDING_STOP_STN, busstopscsv$BUS_STOP_N)]
#convert to lat long
converted <- project(busstopscsv, proj4string, inverse = TRUE)
busstopscsv$long <- converted$y
busstopscsv$lat <- converted$x
holding <- subset(fil, select = c(9,10))
converted <- project(holding, proj4string, inverse = TRUE)
fil$long <- converted$y
fil$lat <- converted$x
overlay <- stat_density2d(aes(x= lat, y = long, fill = ..level.., alpha = ..level..), bins = 10, geom = "polygon", data = fil)
#overlay <- geom_point(data=busstopscsv, aes(x=lat,y=long,size=timeden), alpha = 0.3, size = 0.1)
sgmap + overlay
sgmap + overlay
runApp()
Sys.time()
strptime(Sys.time())
strptime(Sys.time(), "%T")
strptime("23:59:33", "%T")
strptime("23:59:33")
strptime("23:59:33", "%T")
strptime("23:59:33")
strptime("23:59:33", "%T")
strftime(strptime("23:59:33", "%T"))
strftime(strptime("23:59:33", "%T"), format="%H:%M:%OS")
format="%H:%M:%OS"
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
